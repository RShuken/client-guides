<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vishnu Work Done - Ian Ferguson Project</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; line-height: 1.6; max-width: 900px; margin: 40px auto; }
        h1 { color: #2c3e50; }
        h2 { color: #34495e; border-bottom: 2px solid #3498db; padding-bottom: 5px; }
        .date { color: #7f8c8d; font-style: italic; margin-bottom: 24px; }
        .section { margin: 20px 0; }
        .code-block { background-color: #f8f9fa; border-left: 4px solid #3498db; padding: 10px; margin: 10px 0; font-size: 0.9em; overflow-x: auto; }
        .command { font-family: monospace; background-color: #333; color: #fff; padding: 2px 4px; }
        code { background: #f0f0f0; padding: 2px 6px; border-radius: 3px; font-size: 0.9em; }

        /* Work items with collapsible details */
        .work-item { border: 1px solid #e0e0e0; margin: 15px 0; border-radius: 8px; overflow: hidden; }
        .work-item summary {
            padding: 15px;
            cursor: pointer;
            background: #fafafa;
            border-bottom: 1px solid #e0e0e0;
            list-style: none;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .work-item summary::-webkit-details-marker { display: none; }
        .work-item summary::before {
            content: 'â–¶';
            font-size: 0.7em;
            transition: transform 0.2s;
            flex-shrink: 0;
        }
        .work-item[open] summary::before { transform: rotate(90deg); }
        .work-item[open] summary { border-bottom: 1px solid #e0e0e0; }
        .work-item .details-body { padding: 15px; }
        .work-date { font-weight: bold; color: #27ae60; font-size: 0.85em; white-space: nowrap; }
        .work-title { font-weight: 600; color: #2c3e50; font-size: 1.05em; }
        .work-summary { color: #666; font-size: 0.9em; margin-left: auto; }

        /* Status badges */
        .badge { display: inline-block; padding: 2px 8px; border-radius: 4px; font-size: 0.75em; font-weight: 600; }
        .badge-fix { background: #fee2e2; color: #991b1b; }
        .badge-config { background: #dbeafe; color: #1e40af; }
        .badge-setup { background: #d1fae5; color: #065f46; }

        @media (max-width: 640px) {
            body { margin: 16px; }
            .work-item summary { flex-wrap: wrap; }
            .work-summary { display: none; }
        }
    </style>
</head>
<body>
    <h1>Vishnu Work Done Log</h1>
    <div class="date">Tracking all work performed on Ian Ferguson's Vishnu AI Assistant</div>

    <!-- â”€â”€â”€ Feb 10: OpenClaw Upgrade + Opus 4.6 â”€â”€â”€ -->
    <details class="work-item" open>
        <summary>
            <span class="work-date">Feb 10, 2026 â€” 10:15 PM</span>
            <span class="work-title">ðŸš€ Upgraded to OpenClaw + Claude Opus 4.6</span>
            <span class="badge badge-setup">UPGRADE</span>
        </summary>
        <div class="details-body">
            <h4>Problem</h4>
            <p>All models stopped working. Vishnu was showing <strong>"Unknown model: anthropic/claude-opus-4-6"</strong> errors â€” the old <code>clawdbot</code> package (v2026.1.24-3) didn't support the newest Claude model.</p>

            <h4>Root Cause</h4>
            <p>The config was set to use <code>claude-opus-4-6</code> (Claude Opus 4.6), but the installed package was too old to recognize this model. The package name also changed from <code>clawdbot</code> to <code>openclaw</code>.</p>

            <h4>Fix Applied</h4>
            <div class="code-block">
                <strong>Step 1: Install new package</strong><br>
                <span class="command">npm install -g openclaw@latest</span> &nbsp;# v2026.2.9<br><br>

                <strong>Step 2: Stop old service</strong><br>
                <span class="command">clawdbot gateway stop</span><br><br>

                <strong>Step 3: Migrate config</strong><br>
                <span class="command">mkdir -p ~/.openclaw</span><br>
                <span class="command">cp -r ~/.clawdbot/* ~/.openclaw/</span><br>
                <span class="command">mv ~/.openclaw/clawdbot.json ~/.openclaw/openclaw.json</span><br><br>

                <strong>Step 4: Install new gateway service</strong><br>
                <span class="command">openclaw gateway install</span><br><br>

                <strong>Step 5: Cleanup old service</strong><br>
                <span class="command">launchctl bootout gui/501/com.clawdbot.gateway</span><br>
                <span class="command">rm ~/Library/LaunchAgents/com.clawdbot.gateway.plist</span>
            </div>

            <h4>What Changed</h4>
            <table style="width:100%; border-collapse: collapse; margin: 10px 0;">
                <tr style="background: #f8f9fa;">
                    <th style="text-align:left; padding: 8px; border: 1px solid #ddd;">Before</th>
                    <th style="text-align:left; padding: 8px; border: 1px solid #ddd;">After</th>
                </tr>
                <tr>
                    <td style="padding: 8px; border: 1px solid #ddd;"><code>clawdbot</code> v2026.1.24-3</td>
                    <td style="padding: 8px; border: 1px solid #ddd;"><code>openclaw</code> v2026.2.9</td>
                </tr>
                <tr>
                    <td style="padding: 8px; border: 1px solid #ddd;">Claude Opus 4.5</td>
                    <td style="padding: 8px; border: 1px solid #ddd;"><strong>Claude Opus 4.6</strong> (newest)</td>
                </tr>
                <tr>
                    <td style="padding: 8px; border: 1px solid #ddd;"><code>~/.clawdbot/</code></td>
                    <td style="padding: 8px; border: 1px solid #ddd;"><code>~/.openclaw/</code></td>
                </tr>
                <tr>
                    <td style="padding: 8px; border: 1px solid #ddd;"><code>com.clawdbot.gateway</code></td>
                    <td style="padding: 8px; border: 1px solid #ddd;"><code>ai.openclaw.gateway</code></td>
                </tr>
            </table>

            <h4>Result</h4>
            <ul>
                <li>âœ… OpenClaw v2026.2.9 installed (latest)</li>
                <li>âœ… Claude Opus 4.6 now active (newest model)</li>
                <li>âœ… All config and sessions preserved</li>
                <li>âœ… Old clawdbot service removed</li>
                <li>âœ… Gateway running with 200k context window</li>
            </ul>

            <h4>New Commands Reference</h4>
            <div class="code-block">
                <span class="command">openclaw status</span> &nbsp;# Check overall status<br>
                <span class="command">openclaw gateway status</span> &nbsp;# Check gateway<br>
                <span class="command">openclaw gateway restart</span> &nbsp;# Restart if needed<br>
                <span class="command">openclaw config get</span> &nbsp;# View config
            </div>
        </div>
    </details>

    <!-- â”€â”€â”€ Feb 3: Context Overflow Fix â”€â”€â”€ -->
    <details class="work-item" open>
        <summary>
            <span class="work-date">Feb 3, 2026 â€” 4:37 PM</span>
            <span class="work-title">ðŸ”¥ Context Overflow â€” Root Cause &amp; Fix</span>
            <span class="badge badge-fix">FIX</span>
        </summary>
        <div class="details-body">
            <h4>Problem</h4>
            <p>Vishnu was experiencing recurring <strong>context overflow errors</strong> and <strong>API rate limit failures (HTTP 429)</strong>. After investigation, we discovered the root cause: <strong>Ian had shared his entire conversation history from ChatGPT and Claude with Vishnu</strong>, asking it to save everything permanently.</p>

            <h4>Root Cause</h4>
            <p>A transcribed voice message confirmed Ian asked Vishnu to <em>"take all this information and save it and make sure that it's in a place you can reference forever."</em> This caused:</p>
            <ol>
                <li><strong>Memory Database Bloat:</strong> main.sqlite grew to 5.1 MB with 89 embedding entries (vs 4 in a clean database)</li>
                <li><strong>Context Inflation:</strong> Every interaction searched the bloated index, pulling in years of historical context</li>
                <li><strong>Concurrent Session Overload:</strong> Multiple sessions each carrying inflated context triggered cascading rate limits</li>
            </ol>

            <h4>Pre-Fix State â€” Vishnu's Mac Mini</h4>
            <div class="code-block">
                <strong>main.sqlite:</strong> 16 MB (48 chunks, 48 embeddings, 23 memory files from a single day)<br>
                <strong>Total text:</strong> 59 KB actual content buried under 1.9 MB of vector embeddings<br>
                <strong>Result:</strong> Context overflow errors, Claude usage burned through daily limits
            </div>

            <h4>Fix Applied â€” Vishnu's Mac Mini (6:13 PM MST)</h4>
            <div class="code-block">
                <span class="command">ssh vishnu@100.106.206.127</span><br>
                <span class="command">cp ~/.clawdbot/memory/main.sqlite ~/.clawdbot/memory/main.sqlite.bak</span> &nbsp;# backup<br>
                <span class="command">rm ~/.clawdbot/memory/main.sqlite</span> &nbsp;# remove 16 MB bloated DB<br>
                # System auto-rebuilds fresh, minimal database on next use
            </div>

            <h4>Post-Fix Validation</h4>
            <ul>
                <li>âœ… Vishnu database: 16 MB â†’ 0 (clean slate, verified via SSH)</li>
                <li>âœ… Backup preserved as main.sqlite.bak on Vishnu's machine</li>
                <li>âœ… System rebuilds clean database from current workspace files only</li>
                <li>âœ… No more imported ChatGPT/Claude history in the index</li>
            </ul>

            <h4>Lessons Learned</h4>
            <ol>
                <li>Never bulk-import conversation history from other AI platforms â€” summarize key points instead</li>
                <li>Embedding databases grow silently (5.1 MB DB had only 8 KB of readable text)</li>
                <li>Concurrent sessions multiply memory bloat into rate limit cascades</li>
            </ol>
        </div>
    </details>

    <!-- â”€â”€â”€ Feb 3: Rate Limit Optimization â”€â”€â”€ -->
    <details class="work-item">
        <summary>
            <span class="work-date">Feb 3, 2026 â€” 12:25 PM</span>
            <span class="work-title">API Rate Limit Optimization</span>
            <span class="badge badge-config">CONFIG</span>
        </summary>
        <div class="details-body">
            <h4>Problem</h4>
            <p>Vishnu was hitting Anthropic API rate limits (HTTP 429), falling back to Gemini despite having Tier 2 limits (450k tokens/min, 1k requests/min).</p>

            <h4>Solution</h4>
            <ol>
                <li><strong>Reordered Fallback Chain:</strong> Opus â†’ Gemini â†’ Sonnet â†’ GPT-4o (Gemini moved up as faster fallback)</li>
                <li><strong>Preserved Concurrency:</strong> Kept all 4 concurrent agents</li>
                <li><strong>Smart Retry Logic:</strong> 3-minute cooldowns to prevent retry loops</li>
            </ol>

            <h4>Commands</h4>
            <div class="code-block">
                <span class="command">cp ~/.clawdbot/clawdbot.json ~/.clawdbot/clawdbot.json.backup.$(date +%s)</span><br>
                # Updated fallbacks in config: ["gemini-3-pro-preview", "claude-sonnet-4", "gpt-4o"]<br>
                <span class="command">clawdbot gateway restart</span>
            </div>

            <h4>Result</h4>
            <p>When Claude hits rate limits: tries Gemini first (fast), then Sonnet, then GPT-4o. 3-min cooldown prevents retry storms.</p>
        </div>
    </details>

    <!-- â”€â”€â”€ Feb 1-2: Initial Setup â”€â”€â”€ -->
    <details class="work-item">
        <summary>
            <span class="work-date">Feb 1â€“2, 2026</span>
            <span class="work-title">Initial Setup &amp; Configuration</span>
            <span class="badge badge-setup">SETUP</span>
        </summary>
        <div class="details-body">
            <h4>Work Completed</h4>
            <ul>
                <li>undici installed for ClawdHub on Node v25</li>
                <li>Browser set to use clawd profile</li>
                <li>Cooldowns reduced from 1hr â†’ 3min</li>
                <li>Stuck cooldown state cleared</li>
                <li>$60 loaded â†’ Tier 2 rate limits</li>
                <li>Local embeddings for memory search</li>
                <li>Full explainer website created</li>
            </ul>

            <h4>Configuration</h4>
            <ul>
                <li><strong>Primary Model:</strong> Claude Opus 4.6 <em>(upgraded Feb 10)</em></li>
                <li><strong>Fallback Chain:</strong> Opus 4.6 â†’ Sonnet 4 â†’ Gemini 3 Pro â†’ GPT-4o</li>
                <li><strong>API Tier:</strong> Tier 2 ($60) â€” 450k tokens/min, 1k requests/min</li>
                <li><strong>Features:</strong> Web search, browser, heartbeat, nightshift, memory, multi-provider failover</li>
                <li><strong>Package:</strong> OpenClaw v2026.2.9 <em>(upgraded from clawdbot Feb 10)</em></li>
            </ul>
        </div>
    </details>

    <div class="section">
        <h2>About Vishnu</h2>
        <p>Vishnu is Ian Ferguson's personal AI assistant running 24/7 on his Mac Mini. It operates through Telegram (@Vishnuexu_bot) and provides advanced AI capabilities including coding, research, file processing, and contextual memory.</p>
    </div>
</body>
</html>
